"use strict";(self.webpackChunkreport=self.webpackChunkreport||[]).push([[323],{1323:(At,$,l)=>{l.r($),l.d($,{diagram:()=>Dt});var Z=l(5861),a=l(6254),J=l(8814),P=l(1074),r=l(5615),Q=l(4102);l(1764),l(6780),l(2735),l(4688),l(7416);const b="rect",R="rectWithTitle",D="statediagram",st=`${D}-state`,v="transition",nt=`${v} note-edge`,ct=`${D}-note`,rt=`${D}-cluster`,it=`${D}-cluster-alt`,G="parent",N=`----${G}`,w="fill:none",U="fill: #333",K="text",H="normal";let y={},E=0;function x(e="",n=0,t="",i="----"){return`state-${e}${null!==t&&t.length>0?`${i}${t}`:""}-${n}`}const f=(e,n,t,i,c,_)=>{const s=t.id,h=function Et(e){return null==e?"":e.classes?e.classes.join(" "):""}(i[s]);if("root"!==s){let u=b;!0===t.start&&(u="start"),!1===t.start&&(u="end"),t.type!==a.D&&(u=t.type),y[s]||(y[s]={id:s,shape:u,description:r.e.sanitizeText(s,(0,r.c)()),classes:`${h} ${st}`});const o=y[s];t.description&&(Array.isArray(o.description)?(o.shape=R,o.description.push(t.description)):o.description.length>0?(o.shape=R,o.description=o.description===s?[t.description]:[o.description,t.description]):(o.shape=b,o.description=t.description),o.description=r.e.sanitizeTextOrArray(o.description,(0,r.c)())),1===o.description.length&&o.shape===R&&(o.shape=b),!o.type&&t.doc&&(r.l.info("Setting cluster for ",s,M(t)),o.type="group",o.dir=M(t),o.shape=t.type===a.a?"divider":"roundedWithTitle",o.classes=o.classes+" "+rt+" "+(_?it:""));const A={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:s,dir:o.dir,domId:x(s,E),type:o.type,padding:15,centerLabel:!0};if(t.note){const S={labelStyle:"",shape:"note",labelText:t.note.text,classes:ct,style:"",id:s+"----note-"+E,domId:x(s,E,"note"),type:o.type,padding:15},C={labelStyle:"",shape:"noteGroup",labelText:t.note.text,classes:o.classes,style:"",id:s+N,domId:x(s,E,G),type:"group",padding:0};E++;const d=s+N;e.setNode(d,C),e.setNode(S.id,S),e.setNode(s,A),e.setParent(s,d),e.setParent(S.id,d);let g=s,T=S.id;"left of"===t.note.position&&(g=S.id,T=s),e.setEdge(g,T,{arrowhead:"none",arrowType:"",style:w,labelStyle:"",classes:nt,arrowheadStyle:U,labelpos:"c",labelType:K,thickness:H})}else e.setNode(s,A)}n&&"root"!==n.id&&(r.l.trace("Setting node ",s," to be child of its parent ",n.id),e.setParent(s,n.id)),t.doc&&(r.l.trace("Adding nodes children "),St(e,t,t.doc,i,c,!_))},St=(e,n,t,i,c,_)=>{r.l.trace("items",t),t.forEach(s=>{switch(s.stmt){case a.b:case a.D:f(e,n,s,i,c,_);break;case a.S:{f(e,n,s.state1,i,c,_),f(e,n,s.state2,i,c,_);const h={id:"edge"+E,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:w,labelStyle:"",label:r.e.sanitizeText(s.description,(0,r.c)()),arrowheadStyle:U,labelpos:"c",labelType:K,thickness:H,classes:v};e.setEdge(s.state1.id,s.state2.id,h,E),E++}}})},M=(e,n=a.c)=>{let t=n;if(e.doc)for(let i=0;i<e.doc.length;i++){const c=e.doc[i];"dir"===c.stmt&&(t=c.value)}return t},Dt={parser:a.p,db:a.d,renderer:{setConf:function(e){const n=Object.keys(e);for(const t of n);},getClasses:function(e,n){r.l.trace("Extracting classes"),n.db.clear();try{return n.parser.parse(e),n.db.extract(n.db.getRootDocV2()),n.db.getClasses()}catch(t){return t}},draw:function(){var e=(0,Z.Z)(function*(n,t,i,c){r.l.info("Drawing state diagram (v2)",t),y={},c.db.getDirection();const{securityLevel:_,state:s}=(0,r.c)(),h=s.nodeSpacing||50,u=s.rankSpacing||50;r.l.info(c.db.getRootDocV2()),c.db.extract(c.db.getRootDocV2()),r.l.info(c.db.getRootDocV2());const o=c.db.getStates(),A=new J.k({multigraph:!0,compound:!0}).setGraph({rankdir:M(c.db.getRootDocV2()),nodesep:h,ranksep:u,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});let S;f(A,void 0,c.db.getRootDocV2(),o,c.db,!0),"sandbox"===_&&(S=(0,P.Ys)("#i"+t));const C=(0,P.Ys)("sandbox"===_?S.nodes()[0].contentDocument.body:"body"),d=C.select(`[id="${t}"]`),g=C.select("#"+t+" g");yield(0,Q.r)(g,A,["barb"],D,t),r.u.insertTitle(d,"statediagramTitleText",s.titleTopMargin,c.db.getDiagramTitle());const k=d.node().getBBox(),j=k.width+16,V=k.height+16;d.attr("class",D);const Y=d.node().getBBox();(0,r.i)(d,V,j,s.useMaxWidth);const z=`${Y.x-8} ${Y.y-8} ${j} ${V}`;r.l.debug(`viewBox ${z}`),d.attr("viewBox",z);const ut=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const L of ut){const I=L.getBBox(),p=document.createElementNS("http://www.w3.org/2000/svg",b);p.setAttribute("rx",0),p.setAttribute("ry",0),p.setAttribute("width",I.width),p.setAttribute("height",I.height),L.insertBefore(p,L.firstChild)}});return function(t,i,c,_){return e.apply(this,arguments)}}()},styles:a.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,a.d.clear()}}}}]);